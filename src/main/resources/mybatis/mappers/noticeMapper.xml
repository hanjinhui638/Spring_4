<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
  
 <mapper namespace="noticeMapper">
 	
 	<delete id="boardDelete" parameterType="BoardVO">
 		delete notice where num = #{num}
 	</delete>
 	
 	<update id="boardUpdate" parameterType="BoardVO">
 		update notice set title =#{title}, contents=#{contents} where num =#{num}
 	</update>
 	
 	
 	<select id="boardSelect" resultType="NoticeVO" parameterType="NoticeVO">
		select * from notice where num = #{num}
 	</select>

 	<!-- write -->
 	<insert id="boardWrite" parameterType="BoardVO">
 		insert into notice
 		values(board_seq.nextval, #{title}, #{writer}, #{contents}, sysdate,0)
 	</insert>
 	
 	
 	<!-- count -->
 	<select id="boardCount" resultType="java.lang.Integer" parameterType="Pager">
  		select count(num) from notice
  			<choose>
  				<when test="kind =='kt'">
  					where title like '%'||#{search}||'%'
  				</when>
  				<when test ="kind =='kw'">
  					where writer like '%'||#{search}||'%'
  				</when>
  				<otherwise>
  					where contents like '%'||#{search}||'%'
  				</otherwise>
  			</choose>
  	</select>
  	
  	<!-- List -->
 	<select id = "boardList" resultType="NoticeVO" parameterType="Pager">
  	<!-- list에 num변수가 없기 때문에 vo에 담아서 list에 넣어줌  -->
	<!-- NoticeVO는 boardVO 타입 -->
			select* from 
				(select N.*,rownum R from 
					(select * from notice 
						<choose>
							<when test="kind == 'kt'">
								where title like '%'||#{search}||'%' <!-- 연결연산자||-->
							</when>
							<when test = "kind =='kw'">
								where writer like '%'||#{search}||'%'
							</when>
							<otherwise>
								where contents like '%'||#{search}||'%'
							</otherwise>
						</choose>
					order by num desc) N)
				where R between #{startRow} and #{lastRow}
  	</select>
  
 
 
 
 
 
 </mapper>